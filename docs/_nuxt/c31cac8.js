(window.webpackJsonp=window.webpackJsonp||[]).push([[10,2,3,4,5,6,7,8],{231:function(t,e,n){"use strict";var o=n(10),r=n(4),l=n(84),c=n(16),d=n(13),f=n(43),m=n(171),h=n(63),v=n(6),y=n(65),k=n(64).f,_=n(31).f,C=n(15).f,I=n(232).trim,O="Number",$=r.Number,S=$.prototype,j=f(y(S))==O,E=function(t){var e,n,o,r,l,c,d,code,f=h(t,!1);if("string"==typeof f&&f.length>2)if(43===(e=(f=I(f)).charCodeAt(0))||45===e){if(88===(n=f.charCodeAt(2))||120===n)return NaN}else if(48===e){switch(f.charCodeAt(1)){case 66:case 98:o=2,r=49;break;case 79:case 111:o=8,r=55;break;default:return+f}for(c=(l=f.slice(2)).length,d=0;d<c;d++)if((code=l.charCodeAt(d))<48||code>r)return NaN;return parseInt(l,o)}return+f};if(l(O,!$(" 0o1")||!$("0b1")||$("+0x1"))){for(var w,N=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof N&&(j?v((function(){S.valueOf.call(n)})):f(n)!=O)?m(new $(E(e)),n,N):E(e)},T=o?k($):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),x=0;T.length>x;x++)d($,w=T[x])&&!d(N,w)&&C(N,w,_($,w));N.prototype=S,S.constructor=N,c(r,O,N)}},232:function(t,e,n){var o=n(19),r="["+n(233)+"]",l=RegExp("^"+r+r+"*"),c=RegExp(r+r+"*$"),d=function(t){return function(e){var n=String(o(e));return 1&t&&(n=n.replace(l,"")),2&t&&(n=n.replace(c,"")),n}};t.exports={start:d(1),end:d(2),trim:d(3)}},233:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},234:function(t,e,n){"use strict";n.r(e);n(231);var o={props:{number:{type:Number,default:0}}},r=n(12),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(5,(function(e){return n("Icon",{key:e,attrs:{name:"star",className:"m-star "+(e<=t.number?"active":"")}})})),1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Icon:n(170).default})},235:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var o=n(85);var r=n(116);function l(t){return function(t){if(Array.isArray(t))return Object(o.a)(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Object(r.a)(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},236:function(t,e,n){"use strict";n.r(e);var o={props:{book:{type:Object}},methods:{handleShowDialog:function(){this.$store.commit({type:"light/setState",key:"isListDialogVisible",value:!0});var t=this.$props.book;t.count=1,this.$store.commit({type:"light/setState",key:"addBook",value:t})},handleImageClick:function(t){this.$router.push("/light/detail/".concat(t))}}},r=n(12),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-category-item"},[n("img",{staticClass:"m-category-item-img",attrs:{alt:t.book.title,src:t.book.avatar,lazy:""},on:{click:function(e){return t.handleImageClick(t.book.id)}}}),t._v(" "),n("div",{staticClass:"m-category-item-info"},[n("div",[t._v(t._s(t.book.title))]),t._v(" "),n("Stars",{attrs:{number:t.book.stars}}),t._v(" "),n("div",{staticClass:"m-book-price"},[t._v("￥"+t._s(t.book.price))]),t._v(" "),n("button",{on:{click:t.handleShowDialog}},[t._v("添加")])],1)])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Stars:n(234).default})},237:function(t,e,n){"use strict";n.r(e);var o={props:{sidebarItem:{type:Object}},computed:{currentId:function(){return this.$store.state.light.currentId}},methods:{handleNav:function(t){document.getElementById(t).scrollIntoView({block:"start",behavior:"smooth"}),this.$store.commit({type:"light/setState",key:"currentId",value:t}),this.$store.commit({type:"light/setState",key:"isRealScroll",value:!1})}}},r=n(12),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{class:"m-sidebar-item "+(t.currentId===t.sidebarItem.id?"active":""),on:{click:function(e){return t.handleNav(t.sidebarItem.id)}}},[t._v("\n  "+t._s(t.sidebarItem.title)+"\n")])}),[],!1,null,null,null);e.default=component.exports},238:function(t,e,n){"use strict";n.r(e);var o=n(235),r=(n(44),{props:{category:{type:Object}},updated:function(){console.log("子组件更新");var t=Object(o.a)(document.getElementsByClassName("js-category")).map((function(t){return t.offsetTop}));t.push(1/0),this.$emit("onTopArr",t)},mounted:function(){console.log("子组件挂载完"),Object(o.a)(document.getElementsByClassName("js-category")).map((function(t){return t.offsetTop})).push(1/0)}}),l=n(12),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"js-category",attrs:{id:t.category.id}},[n("div",{staticClass:"m-category-title"},[t._v("\n    "+t._s(t.category.title)+"\n  ")]),t._v(" "),t._l(t.category.list,(function(t){return n("CategoryItem",{key:t.id,attrs:{book:t}})}))],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{CategoryItem:n(236).default})},239:function(t,e,n){"use strict";n.r(e);var o={props:{visible:{type:Boolean},title:{type:String}},methods:{handleClose:function(){this.$emit("onClose")},handleOk:function(){this.$emit("onOk")}}},r=n(12),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["m-mask "+(t.visible?"active":"")]},[n("div",{staticClass:"m-dialog"},[n("div",{staticClass:"m-dialog-header"},[n("span",{staticClass:"m-dialog-header-title"},[t._v(t._s(t.title))]),t._v(" "),n("span",{staticClass:"m-dialog-header-close",on:{click:t.handleClose}},[t._v("X")])]),t._v(" "),n("div",{staticClass:"m-dialog-content"},[t._t("content")],2),t._v(" "),n("div",{staticClass:"m-dialog-footer"},[n("button",{staticClass:"m-btn",on:{click:t.handleClose}},[t._v("取消")]),t._v(" "),n("button",{staticClass:"m-btn",on:{click:t.handleOk}},[t._v("确定")])])])])}),[],!1,null,null,null);e.default=component.exports},240:function(t,e,n){"use strict";var o=n(2),r=n(67).findIndex,l=n(115),c="findIndex",d=!0;c in[]&&Array(1).findIndex((function(){d=!1})),o({target:"Array",proto:!0,forced:d},{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),l(c)},241:function(t,e,n){"use strict";n.r(e);n(38),n(27),n(37),n(52),n(32),n(53);var o=n(235),r=n(25),l=n(5),c=(n(45),n(240),n(66),n(46),n(54),n(44),function(){var t;return{showLoading:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t=setTimeout((function(){e.$store.commit({type:"light/setState",key:"isLoading",value:!0})}),n)},hideLoading:function(){clearTimeout(t),this.$store.commit({type:"light/setState",key:"isLoading",value:!1})}}});function d(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function f(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?d(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):d(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var m,h=[],v={computed:{list:function(){return this.$store.state.light.list},currentId:function(){return this.$store.state.light.currentId},addBook:function(){return this.$store.state.light.addBook},isListDialogVisible:function(){return this.$store.state.light.isListDialogVisible}},methods:{handleScroll:function(t){var e=this,n=t.target.scrollTop;if(this.$store.state.light.isRealScroll){var o=n+h[0],r=h.findIndex((function(t,e,n){return t<=o&&o<n[e+1]}));r!==this.$store.state.light.currentId&&this.$store.commit({type:"light/setState",key:"currentId",value:r}),clearTimeout(m),m=setTimeout((function(){e.$store.commit({type:"light/setState",key:"scrollTop",value:n})}),300)}else clearTimeout(m),m=setTimeout((function(){e.$store.commit({type:"light/setState",key:"isRealScroll",value:!0}),e.$store.commit({type:"light/setState",key:"scrollTop",value:n})}),300)},handleClose:function(){this.$store.commit({type:"light/setState",key:"isListDialogVisible",value:!1})},handleTopArr:function(t){h=t},handleOk:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,o,r,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.$store.state.light.addBook,o=c(),r=o.showLoading,l=o.hideLoading,""!==n.count&&(r.bind(t)(),t.$store.dispatch({type:"light/addMyBooks",book:n}).then((function(){t.handleClose(),l.bind(t)()})));case 3:case"end":return e.stop()}}),e)})))()},handleAddCount:function(){var t=f({},this.$store.state.light.addBook);t.count++,this.$store.commit({type:"light/setState",key:"addBook",value:t})},handleSubCount:function(){var t=f({},this.$store.state.light.addBook);t.count>1&&(t.count--,this.$store.commit({type:"light/setState",key:"addBook",value:t}))},handleInputCount:function(t){var e=f({},this.$store.state.light.addBook);e.count=t.target.value.replace(/[^\d]/g,""),""!==e.count&&(e.count=parseInt(e.count)),this.$store.commit({type:"light/setState",key:"addBook",value:f({},e)})}},updated:function(){console.log("父组件更新"),(h=Object(o.a)(document.getElementsByClassName("js-category")).map((function(t){return t.offsetTop}))).push(1/0)},mounted:function(){console.log("父组件挂载完"),this.$refs.list.scrollTop=this.$store.state.light.scrollTop,(h=Object(o.a)(document.getElementsByClassName("js-category")).map((function(t){return t.offsetTop}))).push(1/0)}},y=n(12),component=Object(y.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"list",staticClass:"m-list",on:{scroll:t.handleScroll}},[t._l(t.list,(function(e){return n("Category",{key:e.id,attrs:{category:e},on:{onTopArr:t.handleTopArr}})})),t._v(" "),n("Dialog",{attrs:{visible:t.isListDialogVisible,title:"添加"},on:{onClose:t.handleClose,onOk:t.handleOk},scopedSlots:t._u([{key:"content",fn:function(){return[n("div",{staticClass:"m-add-wrap"},[n("div",{staticClass:"m-add"},[n("button",{staticClass:"m-btn",on:{click:t.handleSubCount}},[t._v("-")]),t._v(" "),n("input",{staticClass:"m-add-input",attrs:{type:"text"},domProps:{value:t.addBook.count},on:{input:t.handleInputCount}}),t._v(" "),n("button",{staticClass:"m-btn",on:{click:t.handleAddCount}},[t._v("+")])])])]},proxy:!0}])})],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Category:n(238).default,Dialog:n(239).default})},242:function(t,e,n){"use strict";n.r(e);var o={computed:{list:function(){return this.$store.state.light.list}}},r=n(12),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-sidebar"},t._l(t.list,(function(t){return n("SidebarItem",{key:t.id,attrs:{sidebarItem:t}})})),1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{SidebarItem:n(237).default})},243:function(t,e,n){"use strict";n.r(e);var o=n(5),r=(n(45),{layout:"light/main",head:{title:"小米书城-首页",meta:[{hid:"description",name:"description",content:"小米书城首页"},{hid:"Keywords",name:"Keywords",content:"小米书城,首页"}]},fetch:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.$store.commit({type:"light/setState",key:"header",value:"小米书城"}),e.next=3,t.$store.dispatch({type:"light/getList"});case 3:case"end":return e.stop()}}),e)})))()}}),l=n(12),component=Object(l.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-main m-home"},[n("Sidebar"),t._v(" "),n("List")],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Sidebar:n(242).default,List:n(241).default})}}]);
//# sourceMappingURL=c31cac8.js.map